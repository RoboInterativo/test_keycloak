server {
   listen 80;
   server_name geekslore.ru;
   return 301  https://geekslore.ru0$request_uri;
}
server {
    listen 443 ssl http2;
    server_name www.wiki.robointerativo.org;
    return 301  https://wiki.robointerativo.org$request_uri;

    ssl_certificate /etc/letsencrypt/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/privkey.pem;




    include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}
server {
    root /var/www/robowiki;
    index index.php  ;
    listen 443 ssl http2;
    server_name wiki.robointerativo.org ;

    error_log /var/log/php-fpm-service_error.log warn;
    access_log /var/log/php-fpm-service-access.log ;
    ssl_certificate /etc/letsencrypt/live/wiki.robointerativo.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/wiki.robointerativo.org/privkey.pem;




    inphp-fpmclude   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
        location / {
        try_files $uri $uri/ /index.php?$args;
    }

    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        # кон php-fpm
        fastcgi_pass php-fpm-service:9000;
        fastcgi_index index.php;
        fastcgi_read_timeout 1000;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
    }


}

#old
server {
   listen 80;
   server_name wiki.robointerativo.ru www.wiki.robointerativo.ru;
   return 301  https://wiki.robointerativo.ru$request_uri;
}
server {
    listen 443 ssl http2;
    server_na   include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
   ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbotme www.wiki.robointerativo.ru;
    return 301  https://wiki.robointerativo.ru$request_uri;

    ssl_certificate /etc/letsencrypt/live/wiki.robointerativo.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/wiki.robointerativo.org/privkey.pem;




    include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {

  listen 443 ssl http2;
  server_name wiki.robointerativo.ru ;

  error_log /var/log/old-err.log warn;
  access_log /var/log/old-access.log ;

  ssl_certificate /etc/letsencrypt/live/wiki.robointerativo.org/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/wiki.robointerativo.org/privkey.pem;

   include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
   ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot


   index index.html  ;
   try_files $uri /index.html;

   location / {
    root /var/www2;
   }






}

#jenkins
upstream jenkins {
 server jenkins:8080;
}

server {
   listen 80;
   server_name jenkins.robointerativo.org ;
   return 301  https://jenkins.robointerativo.org$request_uri;
}
server {
    listen 443 ssl http2;
    server_name jenkins.robointerativo.org;

    error_log /var/log/jenkins-service_error.log warn;
    access_log /var/log/jenkins-service-access.log ;
    ssl_certificate /etc/letsencrypt/live/jenkins.robointerativo.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/jenkins.robointerativo.org/privkey.pem;






      include   /e  volumes:
  - name: jenkinsdata
    persistentVolumeClaim:
      claimName: jenkins-volumetc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
      ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
      location / {
          proxy_pass http://jenkins;
      }



    }

#odoo
upstream odoo {
 server odoo-service:8069;
}

server {
   listen 80;
   server_name team.robointerativo.org ;
   return 301  https://team.robointerativo.org$request_uri;
}
server {
    listen 443 ssl http2;
    server_name team.robointerativo.org;

    error_log /var/log/odoo-service_error.log warn;
    access_log /var/log/odoo-service-access.log ;
    ssl_certificate /etc/letsencrypt/live/team.robointerativo.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/team.robointerativo.org/privkey.pem;






      include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
      ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
      location / {
          proxy_pass http://odoo;
      }



    }
    #testing
    upstream testing {
     server 10.8.0.6:5000;
    }

    server {
       listen 80;
       server_name test1.robointerativo.org ;
       return 301  https://test1.robointerativo.org$request_uri;
    }
    server {
        listen 443 ssl http2;
        server_name test1.robointerativo.org;

        error_log /var/log/testing-service_error.log warn;
        access_log /var/log/testing-service-access.log ;
        ssl_certificate /etc/letsencrypt/live/robointerativo.org/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/robointerativo.org/privkey.pem;






          include   /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
          ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
          location / {
              proxy_pass http://testing;
          }



        }
